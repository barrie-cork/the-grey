{% extends "review_manager/base.html" %}
{% load static %}

{% block title %}Your Literature Reviews - Thesis Grey{% endblock %}

{% block content %}
<div class="dashboard-container">
    <!-- Header Section -->
    <div class="dashboard-header">
        <div class="welcome-section">
            <h1>Your Literature Reviews</h1>
            <div class="quick-stats">
                <span class="stat">
                    <i class="bi bi-journal-text"></i>
                    <strong>{{ total_sessions }}</strong> Total
                </span>
                <span class="stat">
                    <i class="bi bi-activity"></i>
                    <strong>{{ active_sessions }}</strong> Active
                </span>
                <span class="stat">
                    <i class="bi bi-check-circle"></i>
                    <strong>{{ completed_sessions }}</strong> Completed
                </span>
            </div>
        </div>
        <a href="{% url 'review_manager:create_session' %}" 
           class="btn btn-primary btn-lg">
            <i class="bi bi-plus-lg"></i> New Review Session
        </a>
    </div>
    
    <!-- Filters Section -->
    <div class="filters-section">
        <form method="get" class="filter-form" id="dashboard-filter-form">
            <div class="row g-3">
                <div class="col-md-6">
                    <div class="search-box">
                        <input type="text" 
                               name="q" 
                               value="{{ search_query }}"
                               placeholder="Search sessions by title or description..."
                               class="form-control"
                               aria-label="Search sessions">
                    </div>
                </div>
                <div class="col-md-4">
                    <select name="status" 
                            class="form-select" 
                            onchange="this.form.submit()"
                            aria-label="Filter by status">
                        <option value="all">All Sessions</option>
                        <option value="active" {% if current_filter == 'active' %}selected{% endif %}>
                            Active Only
                        </option>
                        <option value="completed" {% if current_filter == 'completed' %}selected{% endif %}>
                            Completed
                        </option>
                        <option value="archived" {% if current_filter == 'archived' %}selected{% endif %}>
                            Archived
                        </option>
                    </select>
                </div>
                <div class="col-md-2">
                    {% if search_query or current_filter != 'all' %}
                    <a href="{% url 'review_manager:dashboard' %}" 
                       class="btn btn-outline-secondary w-100">
                        Clear Filters
                    </a>
                    {% endif %}
                </div>
            </div>
        </form>
    </div>
    
    <!-- Session Cards Grid -->
    <div class="sessions-grid">
        {% for session in sessions %}
            {% include 'review_manager/components/session_card.html' with session=session %}
        {% empty %}
        <div class="empty-state">
            <i class="bi bi-journal-x display-1 text-muted"></i>
            <h3>No sessions found</h3>
            <p class="text-muted">Create your first literature review to get started!</p>
            <a href="{% url 'review_manager:create_session' %}" 
               class="btn btn-primary">
                <i class="bi bi-plus-lg"></i> Create First Session
            </a>
        </div>
        {% endfor %}
    </div>
    
    <!-- Pagination -->
    {% if is_paginated %}
    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            {% if page_obj.has_previous %}
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if search_query %}&q={{ search_query }}{% endif %}{% if current_filter != 'all' %}&status={{ current_filter }}{% endif %}">
                    Previous
                </a>
            </li>
            {% endif %}
            
            {% for num in page_obj.paginator.page_range %}
            <li class="page-item {% if page_obj.number == num %}active{% endif %}">
                <a class="page-link" href="?page={{ num }}{% if search_query %}&q={{ search_query }}{% endif %}{% if current_filter != 'all' %}&status={{ current_filter }}{% endif %}">
                    {{ num }}
                </a>
            </li>
            {% endfor %}
            
            {% if page_obj.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if search_query %}&q={{ search_query }}{% endif %}{% if current_filter != 'all' %}&status={{ current_filter }}{% endif %}">
                    Next
                </a>
            </li>
            {% endif %}
        </ul>
    </nav>
    {% endif %}
</div>
{% endblock %}